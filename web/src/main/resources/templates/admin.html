<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta name="viewport" content="width=device-width,
                                     initial-scale=1.0,
                                     maximum-scale=1.0,
                                     user-scalable=no">
    <title>Title</title>
    <script type="text/javascript" src="../static/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="../static/jquery.form.js"></script>
    <link type="text/css" rel="stylesheet" href="../static/bootstrap-3.3.7-dist/css/bootstrap.css"></link>
    <script type="text/javascript" src="../static/bootstrap-3.3.7-dist/js/bootstrap.js"></script>
    <script type="text/javascript">
        $(function(){
            var pageSize = 10;
            $("#toAccount").click(function(){
                var navLink = $(this).parent();
                var linkNodes = $(navLink).find("li");
                $.each(linkNodes, function(index, obj){
                    $(obj).removeAttr("class")
                })
                $(this).attr("class", "active")
                $.ajax({
                    url: '/getPost/allState/1/' + pageSize,
                    type: 'get',
                    dataType: 'json',
                    success: function(data){
                        console.log(data)
                        if(data.code==0){
                            $("#content").empty();
                            $.each(data.data.list, function(index, post){
                                var btnCotent = "";
                                if(post.state==0){
                                    btnCotent = "<td><button class='btn btn-default toDisable' postId="+post.postId+">禁用</button></td>"
                                }else if(post.state==1){
                                    btnCotent = "<td><button class='btn btn-danger toEnable'"+post.postId+">解禁</button></td>"
                                }
                                $("#content").append('<div class="panel panel-default postNode" style="height: 250px; padding: 5px; margin: 10px">\n' +
                                    '                    <span class="postId" style="visibility: hidden;">' + post.postId +'</span>\n' +
                                    '                    <table style="height: 20%; width: 100%;">\n' +
                                    '                        <tr>\n' +
                                    '                            <td  width="7%" style="color: darkgray;">共 '+ post.segmentCount +'楼</td>\n' +
                                    '                            <td width="80%"><a postId="'+ post.postId +'" class="postInfoLink"  target="_blank"  href="#" >'+post.contentList[0]+'</a></td>\n' +
                                    '                            <td width="10%" align="center"style="color: darkgray"><span>'+ post.userName +'</span> <br/><br/><span style="color: darkgray" >'+ post.createTime +'</span></td>\n'+
                                    btnCotent +
                                    '                        </tr>\n' +
                                    '                    </table>\n' +
                                    '\n' +
                                    '                    <table width="100%" style="height: 50%;">\n' +
                                    '                        <tr>\n' +
                                    '                            <td width="5%"></td>\n' +
                                    '                            <td width="20%"><img src="'+post.contentList[1]+'" class="imgContent" width="100%" /></td>\n' +
                                    '                            <td width="20%"><img src="'+post.contentList[2]+'" class="imgContent" width="100%" /></td>\n' +
                                    '                            <td width="20%"><img src="'+post.contentList[3]+'" class="imgContent" width="100%" /></td>\n' +
                                    '                            <td width="40%"></td>\n' +
                                    '                        </tr>\n' +
                                    '                    </table>\n' +
                                    '                    <span style="width: 60%;"></span>\n' +
                                    '                </div>');
                            })

                            $(".toDisable").click(function(){
                                var postId = $(this).attr("postId")
                                var thisNode = $(this)
                                $.ajax({
                                    url: '/post/disable/' + postId,
                                    type: 'put',
                                    success: function(data){
                                        console.log(data)
                                        if(data.code==0){
                                            $(thisNode).attr("class", "btn btn-danger")
                                            $(thisNode).text("解禁")
                                        }
                                    }
                                })

                            })

                            $(".toEnable").click(function(){
                                alert("toEnable")
                            })

                        }
                    }
                })
            })

            $("#toPublish").click(function(){
                var navLink = $(this).parent();
                var linkNodes = $(navLink).find("li");
                $.each(linkNodes, function(index, obj){
                    $(obj).removeAttr("class")
                })
                $(this).attr("class", "active")
                $.ajax({
                    url: '',
                    type: '',
                    dataType: 'json',
                    success: function(data){
                        console.log(data)
                        if(data.code==0){
                            $("#content").empty();
                            $("#content").append();
                        }
                    }
                })
            })

            $("#toCollect").click(function(){
                var navLink = $(this).parent();
                var linkNodes = $(navLink).find("li");
                $.each(linkNodes, function(index, obj){
                    $(obj).removeAttr("class")
                })
                $(this).attr("class", "active")
                $.ajax({
                    url: '',
                    type: '',
                    dataType: 'json',
                    success: function(data){
                        console.log(data)
                        if(data.code==0){
                            $("#content").empty();
                            $("#content").append();
                        }
                    }
                })
            })
        })
    </script>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-sm-1">
        </div>
        <div class="col-sm-9" style="border-left: 1px solid #d5d5d5">
            <nav class="navbar navbar-default" role="navigation">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <a class="navbar-brand" href="#" style="text-align: center; color: #2e6da4; font-weight:bold;">网络社区</a>
                    </div>
                    <div>
                        <ul class="nav navbar-nav">
                            <li class="dropdown"><a href="#" style="color: #2e6da4;">社区首页</a></li>
                            <li><a href="/toArticle" target="_blank">文库</a></li>
                            <li><a href="/toQuestion" target="_blank">问答</a></li>
                        </ul>
                    </div>
                    <form class="navbar-form navbar-left" role="search">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search" id="searchContent">
                        </div>
                        <button type="submit"  class="btn btn-default" id="entryCategory">进入社区</button>
                        <!--<button class="btn btn-default">我要发帖</button>-->
                    </form>
                    <div>
                        <ul class="nav navbar-nav navbar-right" id="userNav">
                            <li th:if="${session.user}">
                                <div>
                                    <div class="dropdown" align="left">
                                        <span class="dropdown-toggle" id="menu1" data-toggle="dropdown" >
                                             <img th:src="@{${session.user.userPic}}" width="45px" src="../static/img/da8e974dc_xs.jpg" class="img-thumbnail"/>
                                        </span>
                                        <ul class="dropdown-menu" role="menu" aria-labelledby="menu1">
                                            <li role="presentation"><a role="menuitem" tabindex="-1" href="/toHomePage" target="_blank">个人中心</a></li>
                                            <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="logoutNode">退出登录</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>

                            <li th:if="${session.user==null}"><a href="/toRegister" target="_blank"><span class="glyphicon glyphicon-user"></span> 注册</a></li>
                            <li th:if="${session.user==null}"><a id="toLogin" href="/toLogin" target="_blank"><span class="glyphicon glyphicon-log-in"></span> 登录</a></li>
                        </ul>
                    </div>
                </div>

            </nav>
            <div class="col-sm-2">
                <ul class="nav nav-pills nav-stacked" role="tablist" id="selectBtn">
                    <li id="toAccount"><a href="#" >帖子</a></li>
                    <li id="toPublish"><a href="#" >问答</a></li>
                    <li id="toCollect"><a href="#" >文库</a></li>
                    <li id="report"><a href="#">举报</a></li>
                </ul>
            </div>
            <div id="content" class="col-sm-10">

            </div>
        </div>
    </div>
    <div class="col-sm-1">

    </div>
</div>

</body>
</html>